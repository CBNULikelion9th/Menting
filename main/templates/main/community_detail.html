{% extends 'accounts/base.html' %}
<!DOCTYPE html>
{% load static %}
{% block content %}
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Community</title>
    <link href="{% static 'css/common.css' %}" rel="stylesheet">
    <link href="{% static 'css/community_detail.css' %}" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>

<body>
    <div class="community_detail">
        <br>
        <h1>제목 : {{ post.title }}</h1>
        <br>
        <p>작성자 : {{ post.user }}</p>
        <p>{{ post.content }}</p>
        <small> 작성시간 : {{ post.updated_at }}</small>



        {% if user.is_authenticated == True %}
        <form action="{% url 'community_comment' post.id %}" method="POST">
            <br>
            {% csrf_token %}
            <div class="form_community_detail">
                <textarea class="form-content" name="content" rows="2" cols="100"></textarea>
            </div>
            <br>
            <br>
            <input type="submit" value="작성" class="btn btn-outline-secondary">
            <button class="btn btn-outline-secondary"><a href="{% url 'community_detail' post.id %}"
                    class="link-dark">취소</a></button>
        </form>
        {% endif %}

        <br><br>
        <h4>댓글 목록</h4>
        <br>
        {% for comment in post.comment_set.all %}
        <div class="container">
            <div class="card">
                <div class="card-body">
                    <p2> 작성자 : {{ comment.name }}</p2>
                    <br>
                    <p2> 내용 : {{ comment.content }}</p2>
                    <br>

                    <form action="{% url 'community_recomment' post.id comment.id %}" method="POST">
                        {% csrf_token %}
                        {% if user.is_authenticated == True %}
                        댓글 : {{ recomment_form.content }}

                        <br><br>
                        <input type="submit" value="확인" class="btn btn-outline-secondary">
                    </form>
                    {% endif %}

                    <br>
                    {% for recomment in comment.recomment_set.all %}
                    <p2> -> 작성자 : {{ recomment.name2 }}</p2>
                    <br>
                    <p2> -> 대댓글 : {{ recomment.content }} </p2>
                    <br>
                    <p2> {{ recomment.updated_at }} </p2>
                    <br><br>
                    {% if user.is_authenticated and user.username == recomment.name2 %}
                    <button class="btn btn-outline-secondary" id="delete_button"><a
                            href="{% url 'recomment_delete' post.id recomment.id %}" class="link-dark">삭제</a></button>
                    <br><br>
                    {% endif %}
                    {% endfor %}

                    {% if user.is_authenticated and user.username == comment.name %}
                    <button class="btn btn-outline-secondary" id="delete_button"><a
                            href="{% url 'comment_delete' post.id comment.id %}" class="link-dark">댓글삭제</a></button>
                    <button class="btn btn-outline-secondary" id="delete_button"><a
                            href="{% url 'comment_edit' post.id comment.id %}" class="link-dark">편집</a></button>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <div class="community_end">
        <br>
        <button class="btn btn-outline-secondary"><a href="{% url 'community_page' %}" class="link-dark">목록</a></button>
        {% if user.is_authenticated and user == post.user %}
        <button class="btn btn-outline-secondary"><a href="{% url 'community_edit' post.id %}"
                class="link-dark">편집</a></button>
        <button class="btn btn-outline-secondary"><a href="{% url 'community_delete' post.id %}"
                class="link-dark">삭제</a></button>
        <br><br><br>
        {% endif %}

    </div>





    <footer>
        <div class="inner">
            <div class="info">
                <span>멋쟁이사자처럼 at 충북대학교 2조팀.</span>
            </div>

            <p class="copyright">
                &copy; <span class="this-year"></span> 2021 Menting Project
            </p>
        </div>
    </footer>
</body>

</html>
{% endblock content %}